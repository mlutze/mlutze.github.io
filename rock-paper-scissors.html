<!DOCTYPE html>
<html>
<head>
    <style>
        .center {
            margin-left: auto;
            margin-right: auto;
        }
    </style>
<script>
    // 0th index is placeholder
    let choices = [null, null, null]
    let canvas_size = 100;
    let height = 60;
    let center = canvas_size / 2;
    function drawCircle(canvas) {
        let radius = height / 2;
        let context = canvas.getContext("2d");
        context.beginPath();
        context.arc(center, center, radius, 0, 2 * Math.PI);
        context.fill();
    }

    function drawSquare(canvas) {
        let side = height;
        let topleft = center - side / 2;
        let context = canvas.getContext("2d");
        context.beginPath();
        context.rect(topleft, topleft, side, side);
        context.fill();
    }

    function drawTriangle(canvas) {
        let side = height * 2 / Math.sqrt(3);
        let bottom = center + height / 2;
        let top = center - height / 2;
        let left = center - side / 2;
        let right = center + side / 2;
        let context = canvas.getContext("2d");
        context.moveTo(center, top);
        context.beginPath();
        context.lineTo(left, bottom);
        context.lineTo(right, bottom);
        context.lineTo(center, top);
        context.fill();
    }

    function onPick(player, shape) {
        console.log("clicked");
        // disable all buttons for that player
        let playerButtons = document.getElementsByClassName("button_player" + player);
        for (let button of playerButtons) {
            button.disabled = true;
        }

        // highlight the selected button
        let button = document.getElementById("button_player" + player + "_" + shape);
        button.style.backgroundColor = "gold";

        // record the chosen shape
        choices[player] = shape;
        
        // check if other player has also selected
        if (choices[3 - player] !== null) {
            onBothPicked();
        }
    }

    function onBothPicked() {
        if (beats(choices[1], choices[2])) {
            reportResult(1);
        } else if (beats(choices[2], choices[1])) {
            reportResult(2);
        } else {
            reportResult(0);
        }
    }

    function reportResult(winner) {
        let winnerBox = document.getElementById("winner");
        if (winner === 0) {
            winnerBox.innerText = "Draw"
        } else {
            winnerBox.innerText = "Player " + winner + " Wins"
        }
        // add to log
    }

    function beats(s1, s2) {
        return (s1 === "circle" && s2 === "triangle")
            || (s1 === "triangle" && s2 === "square")
            || (s1 === "square" && s2 === "circle");
    }

    onload = function() {
        let circles = document.getElementsByClassName("circle");
        let squares = document.getElementsByClassName("square");
        let triangles = document.getElementsByClassName("triangle");
        for (let circle of circles) {
            drawCircle(circle);
        }

        for (let square of squares) {
            drawSquare(square);
        }

        for (let triangle of triangles) {
            drawTriangle(triangle);
        }

    }
</script>

</head>
<body>
<table>
<tr>
    <td colspan="3" style="text-align: center;">
    <h1>Player 1</h1>
    </td>
    <td colspan="3" style="text-align: center;">
    <h1>Player 2</h1>
    </td>
</tr>
<tr>
    <td>
    <button id="button_player1_circle" class="button_player1" onclick="onPick(1, 'circle')">
        <canvas class="circle" width="100" height="100"/>
    </button>
    </td>
    <td>
    <button id="button_player1_square" class="button_player1" onclick="onPick(1, 'square')">
        <canvas class="square" width="100" height="100"/>
    </button>
    </td>
    <td>
    <button id="button_player1_triangle" class="button_player1" onclick="onPick(1, 'triangle')">
        <canvas class="triangle" width="100" height="100"/>
    </button>
    </td>
    <td>
    <button id="button_player2_circle" class="button_player2" onclick="onPick(2, 'circle')">
        <canvas class="circle" width="100" height="100"/>
    </button>
    </td>
    <td>
    <button id="button_player2_square" class="button_player2" onclick="onPick(2, 'square')">
        <canvas class="square" width="100" height="100"/>
    </button>
    </td>
    <td>
    <button id="button_player2_triangle" class="button_player2" onclick="onPick(2, 'triangle')">
        <canvas class="triangle" width="100" height="100"/>
    </button>
    </td>
</tr>
<tr>
    <td colspan="6"><h2 style="text-align: center" id="winner"></h2></td>
</tr>
<tr>
    <td colspan="6">
        <table class="center">
            <thead>
                <tr colspan="3">
                    <h3 style="text-align: center;">History</h3></tr>
                <tr>
                    <td>
                        <h4>Player 1</h4>
                    </td>
                    <td>
                        <h4>Player 2</h4>
                    </td>
                    <td>
                        <h4>Winner</h4>
                    </td>
                </tr>
            </thead>
            <tbody>
            </tbody>
        </table>
    </td>
</tr>
</table>
<!--
components:
- log
- 3 buttons each side
- player 1 dropdown (AI/player)
- player 2 dropdown (AI/player)
- seed
- immediate result box

 -->
</body>
</html>