<!DOCTYPE html>
<html>
<head>
<template id="semaphore-romeo">
<svg xmlns="http://www.w3.org/2000/svg" width="600" height="500" version="1.0">
<circle cx="300" cy="210" r="25"/>
<rect x="265" y="240" height="160" width="70" rx="20" ry="20"/>
<g id="armL">
<rect x="340" y="240" width="70" height="20" rx="10" ry="10"/>
<path d="M399,244.5h200.5v101h-91v-90h-110z"/>
<path d="M509.5,255.5h89v89h-89z" fill="#ff0"/>
<path d="M509.5,255.5l89,89v-89z" fill="#f00"/>
</g>
<g 
    transform="rotate(90 250 250)"
    id="armR">
<rect x="190" y="240" width="70" height="20" rx="10" ry="10"/>
<path d="M0,244.5h200.5v11h-110v90h-91z"/>
<path d="M.5,255.5h89v89h-89z" fill="#ff0"/>
<path d="M.5,255.5h89l-89,89z" fill="#f00"/>
</g>
<circle cx="250" cy="250" r="5" fill = "pink"/>
<circle cx="350" cy="250" r="5" fill = "pink"/>
</svg>
</template>
<script>
let positions = new Map();
positions.set("a", [135, 180]);
positions.set("b", [90, 180]);
positions.set("c", [45, 180]);
positions.set("d", [0, 180]);
positions.set("e", [180, 45]);
positions.set("f", [180, 90]);
positions.set("g", [180, 135]);
positions.set("h", [90, 225]);
positions.set("i", [45, 225]);
positions.set("j", [0, 90]);
positions.set("k", [135, 0]);
positions.set("l", [135, 45]);
positions.set("m", [135, 90]);
positions.set("n", [135, 135]);
positions.set("o", [90, -45]);
positions.set("p", [90, 0]);
positions.set("q", [90, 45]);
positions.set("r", [90, 90]);
positions.set("s", [90, 135]);
positions.set("t", [45, 0]);
positions.set("u", [45, 45]);
positions.set("v", [0, 135]);
positions.set("w", [-45, 90]);
positions.set("x", [-45, 135]);
positions.set("y", [45, 90]);
positions.set("z", [-135, 90]);
positions.set(" ", [180, 180]);
positions.set("#", [0, 45]);
positions.set("<", [45, 135]);

// returns an svg node corresponding to the given character
function draw(char) {
    let template = document.getElementById("semaphore-romeo");
    let node = template.content.cloneNode(true);
    let rightRot = positions.get(char)[0];
    let leftRot = positions.get(char)[1];
    node.getElementById("armL").setAttribute("transform", "rotate(" + (leftRot + 270) + " 350 250)");
    node.getElementById("armR").setAttribute("transform", "rotate(" + (90 - rightRot) + " 250 250)");
    return node;
}

function animate(string, speed, canvas) {
    // create an svg
    // start with semaphore: romeo
    // for each letter:
        // append animation from previous position
        // need a from-to function to animate from one letter to the next
        // ensure each animation starts after the previous
        // arms move at once
        // probably pause between movements (configurable duration)
        
    // TODO displays the string as semaphore on the given canvas
}

function drawFrame(left, right, canvas) {
    // TODO displays figure with arms turned to the given angle
}

onload = () => {
    document.getElementById("canvas").replaceWith(draw("<"));
}
// canvas for display
// alphabet
// speed controls
// submission
// solution
// steal from morse code stuff
</script>
</head>
<body>
    <svg id="canvas"></svg>
</body>
</html>