<!DOCTYPE html>
<html>
<head>
    <script src="https://cwjs.mastercw.com/cw.min.js"></script>
    <script src="https://neil.fraser.name/software/diff_match_patch/javascript/diff_match_patch.js"></script>
    <script>
        // TODO: need playback speed buttons
        // TODO: group things to separate setup and execution
    
    var secretText = "";

    function diff() {
        let solution = document.getElementById("solution");
        let submission = document.getElementById("submission");
        let base = solution.value;
        let changed = submission.value;

        dmp.diff_main(solution);
        // TODO do something with this
    }

    function play() {
        cw.play(secretText);
    }

    function randomChoice(arr) {
        return arr[randomInt(0, arr.length)];
    }

    function randomInt(min, max) {
        return Math.floor(Math.random() * (max - min)) + min;
    }

    function randomWord(alphabet, wordMin, wordMax) {
        let word = "";
        let length = randomInt(wordMin, wordMax);
        for (let i = 0; i < length; i++) {
            word += randomChoice(alphabet);
        }
        console.log(wordMin);
        console.log(wordMax);
        console.log(length);
        console.log(word);
        return word;
    }
    
    function makeRandomText(alphabet, wordMin, wordMax, length) {
        let text = "";
        while (text.length < length) {
            text += randomWord(alphabet, wordMin, wordMax) + " ";
        }
        return text.slice(0, length);
    }

    function generate() {
        let alphabet = document.getElementById("alphabet").value;
        let wordMin = parseInt(document.getElementById("wordMin").value);
        let wordMax = parseInt(document.getElementById("wordMax").value);
        let length = parseInt(document.getElementById("length").value);

        let solution = document.getElementById("solution");

        let text = makeRandomText(alphabet, wordMin, wordMax, length);
        secretText = text;
        solution.value = "*".repeat(length);
    }

    function showSolution() {
        let solution = document.getElementById("solution");
        solution.value = secretText;
    }

    onload = function() {
        

    }
    </script>
</head>
<body>
<input id="alphabet"/>
<textarea id="submission">
</textarea>
<textarea id="solution" disabled="true">
</textarea>
<button id="generate" onclick="generate();">
Generate
</button>
<button id="showSolution" onclick="showSolution();">
    Show Solution
</button>
<button>
    Record Result
</button>
<button id="play" onclick="play();">
    Play
</button>
<input id="wordMin" type="number" value="1"/>
<input id="wordMax" type="number" value="7"/>
<input id="length" type="number" value="100"/>
</body>
</html>